window.__require=function t(e,c,i){function o(r,a){if(!c[r]){if(!e[r]){var s=r.split("/");if(s=s[s.length-1],!e[s]){var u="function"==typeof __require&&__require;if(!a&&u)return u(s,!0);if(n)return n(s,!0);throw new Error("Cannot find module '"+r+"'")}r=s}var d=c[r]={exports:{}};e[r][0].call(d.exports,function(t){return o(e[r][1][t]||t)},d,d.exports,t,e,c,i)}return c[r].exports}for(var n="function"==typeof __require&&__require,r=0;r<i.length;r++)o(i[r]);return o}({Fruit:[function(t,e){"use strict";cc._RF.push(e,"365b4UAiQRBA7QXa2IuFMmj","Fruit"),cc.Class({extends:cc.Component,properties:{id:0,fruit_statue:0},init:function(t){this.id=t.id;var e=this.node.getComponent(cc.Sprite);this.node.getComponent(cc.CircleCollider).radius=t.iconSF._rect.height/2,e.spriteFrame=t.iconSF},start:function(){},onBeginContact:function(t,e,c){if(e.node&&c.node&&e.node.getComponent("Fruit")&&c.node.getComponent("Fruit")){var i=e.node.getComponent("Fruit"),o=c.node.getComponent("Fruit");i&&o&&i.id===o.id&&e.node.emit("sameContact",{self:e,other:c})}}}),cc._RF.pop()},{}],GameOver:[function(t,e){"use strict";cc._RF.push(e,"28372YWiYtEjKoMHD/mx6vi","GameOver"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){cc.director.getCollisionManager().enabled=!0},onCollisionEnter:function(t,e){e.node.emit("GAMEOVER",t.node)}}),cc._RF.pop()},{}],Game:[function(t,e){"use strict";cc._RF.push(e,"8e80dMWyH5LD7Oj100K42f8","Game");var c=cc.Class({name:"FruitItem",properties:{id:0,iconSF:cc.SpriteFrame}}),i=cc.Class({name:"JuiceItem",properties:{particle:cc.SpriteFrame,circle:cc.SpriteFrame,slash:cc.SpriteFrame}});cc.Class({extends:cc.Component,properties:{fruits:{default:[],type:c},juices:{default:[],type:i},fruitPrefab:{default:null,type:cc.Prefab},juicePrefab:{default:null,type:cc.Prefab},boomAudio:{default:null,type:cc.AudioClip},knockAudio:{default:null,type:cc.AudioClip},waterAudio:{default:null,type:cc.AudioClip},start_bg:{default:null,type:cc.Node},top_death:{default:null,type:cc.Node},score_label:{default:null,type:cc.Label},fruits_bg:{default:null,type:cc.Node},play_again:{default:null,type:cc.Node},voice_bt:{default:null,type:cc.Node},game_over:{default:null,type:cc.Node}},onLoad:function(){this.img_scale=.6,this.score_label.string=cc.sys.localStorage.getItem("local_score")||0,this.game_over.zIndex=1,this.game_over.active=!1;var t=this;cc.resources.preload("close",cc.SpriteFrame),cc.resources.preload("open",cc.SpriteFrame);var e=cc.sys.localStorage.getItem("voice_status");this.voice_status="0"!==e,cc.resources.load(this.voice_status?"open":"close",cc.SpriteFrame,function(e,c){t.voice_bt.getComponent(cc.Sprite).spriteFrame=c}),this.top_death.zIndex=1,this.top_death.on("GAMEOVER",this.end_game.bind(this)),this.initPhysics(),window.IS_RELOAD&&this.start_game()},start_game:function(){this.game_status=1,this.fruits_bg.active=!1,this.score_label.string=0,this.start_bg.active=!1,this.isCreating=!1,this.fruitCount=0,this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.initOneFruit()},end_game:function(t){this.game_status=0;var e=t.getComponent(cc.Animation).play();e.wrapMode=cc.WrapMode.Loop,e.repeatCount=1/0,this.show_game_over_bg(),cc.sys.localStorage.setItem("local_score",this.score_label.string)},initPhysics:function(){var t=cc.director.getPhysicsManager();t.enabled=!0,t.gravity=cc.v2(0,-1e3),cc.director.getCollisionManager().enabled=!0},initOneFruit:function(t){void 0===t&&(t=1),this.fruitCount++,this.currentFruit=this.createFruitOnPos(0,380,t,!0)},onTouchStart:function(t){if(!this.isCreating){var e=this.node.convertToNodeSpaceAR(t.getLocation()),c=e.x;e.y,this.currentFruit.setPosition(cc.v2(c,380))}},onTouchMove:function(t){if(!this.isCreating){var e=this.node.convertToNodeSpaceAR(t.getLocation()),c=e.x;e.y,this.currentFruit.setPosition(cc.v2(c,380))}},onTouchEnd:function(){var t=this;if(!this.isCreating){this.isCreating=!0;var e=this.currentFruit;this.startFruitPhysics(e),this.scheduleOnce(function(){if(1===t.game_status){var e=t.getNextFruitId();t.initOneFruit(e),t.isCreating=!1}},.5)}},getNextFruitId:function(){return this.fruitCount<3?1:3===this.fruitCount?2:Math.floor(5*Math.random())+1},createOneFruit:function(t){var e=cc.instantiate(this.fruitPrefab),c=this.fruits[t-1];return e.getComponent("Fruit").init({id:c.id,iconSF:c.iconSF}),e.getComponent(cc.RigidBody).type=cc.RigidBodyType.Static,e.getComponent(cc.PhysicsCircleCollider).radius=0,this.node.addChild(e),e.scale=this.img_scale,e.on("sameContact",this.onSameFruitContact.bind(this)),e},startFruitPhysics:function(t){this.scheduleOnce(function(){t.getComponent("Fruit").fruit_statue},.5);var e=t.getComponent(cc.PhysicsCircleCollider);e.radius=t.height/2,e.apply(),t.getComponent(cc.RigidBody).type=cc.RigidBodyType.Dynamic},createFruitOnPos:function(t,e,c,i){void 0===c&&(c=1),void 0===i&&(i=!1);var o=this.createOneFruit(c);return i&&(o.scale=0,cc.tween(o).to(.3,{scale:this.img_scale},{easing:"backOut"}).start()),o.setPosition(cc.v2(t,e)),o},onSameFruitContact:function(t){var e=t.self,c=t.other;c.node.off("sameContact");var i=c.getComponent("Fruit").id;this.score_label.string=parseInt(i)+parseInt(this.score_label.string),e.node.removeFromParent(!1),c.node.removeFromParent(!1);var o=c.node.y<e.node.y?c.node:e.node,n=o.x,r=o.y;this.createFruitJuice(i,cc.v2({x:n,y:r}),c.node.width);var a=i+1;if(a<=11){var s=this.createFruitOnPos(n,r,a);this.startFruitPhysics(s),s.scale=0,cc.tween(s).to(.5,{scale:this.img_scale},{easing:"backOut"}).start()}else console.log(" todo \u5408\u6210\u4e24\u4e2a\u897f\u74dc \u8fd8\u6ca1\u6709\u5b9e\u73b0\u54e6~ ")},createFruitJuice:function(t,e,c){this.voice_status&&(cc.audioEngine.play(this.boomAudio,!1,1),cc.audioEngine.play(this.waterAudio,!1,1));var i=cc.instantiate(this.juicePrefab);this.node.addChild(i);var o=this.juices[t-1],n=i.getComponent("Juice");n.init(o),n.showJuice(e,c)},show_game_over_bg:function(){cc.director.getPhysicsManager().enabled=!1,this.game_over.active=!0,this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this)},againGame:function(){window.IS_RELOAD=!0,cc.director.loadScene("game")},closevoice:function(){var t=this;"open"===t.voice_bt.getComponent(cc.Sprite).spriteFrame.name?cc.resources.load("close",cc.SpriteFrame,function(e,c){t.voice_bt.getComponent(cc.Sprite).spriteFrame=c,t.voice_status=!1,cc.sys.localStorage.setItem("voice_status","0")}):cc.resources.load("open",cc.SpriteFrame,function(e,c){t.voice_bt.getComponent(cc.Sprite).spriteFrame=c,t.voice_status=!0,cc.sys.localStorage.setItem("voice_status","1")})}}),cc._RF.pop()},{}],Juice:[function(t,e){"use strict";cc._RF.push(e,"56c1eHSOMxI0L+m6MX8FMXw","Juice");var c=function(t,e){return Math.floor(Math.random()*(e-t)+t)};cc.Class({extends:cc.Component,properties:{particle:{default:null,type:cc.SpriteFrame},circle:{default:null,type:cc.SpriteFrame},slash:{default:null,type:cc.SpriteFrame}},init:function(t){this.particle=t.particle,this.circle=t.particle,this.slash=t.slash},showJuice:function(t,e){for(var i=this,o=function(o){var n=new cc.Node("Sprite");n.addComponent(cc.Sprite).spriteFrame=i.particle,n.parent=i.node;var r=359*Math.random(),a=(o=30*Math.random()+e/2,cc.v2(Math.sin(r*Math.PI/180)*o,Math.cos(r*Math.PI/180)*o));n.scale=.5*Math.random()+e/100;var s=.5*Math.random();n.position=t,n.runAction(cc.sequence(cc.spawn(cc.moveBy(s,a),cc.scaleTo(s+.5,.3),cc.rotateBy(s+.5,c(-360,360))),cc.fadeOut(.1),cc.callFunc(function(){n.active=!1},i)))},n=0;n<10;++n)o(n);for(var r=function(){var c=new cc.Node("Sprite");c.addComponent(cc.Sprite).spriteFrame=i.circle,c.parent=i.node;var o=359*Math.random(),n=30*Math.random()+e/2,r=cc.v2(Math.sin(o*Math.PI/180)*n,Math.cos(o*Math.PI/180)*n);c.scale=.5*Math.random()+e/100;var a=.5*Math.random();c.position=t,c.runAction(cc.sequence(cc.spawn(cc.moveBy(a,r),cc.scaleTo(a+.5,.3)),cc.fadeOut(.1),cc.callFunc(function(){c.active=!1},i)))},a=0;a<20;a++)r();var s=new cc.Node("Sprite");s.addComponent(cc.Sprite).spriteFrame=this.slash,s.parent=this.node,s.position=t,s.scale=0,s.angle=c(0,360),s.runAction(cc.sequence(cc.spawn(cc.scaleTo(.2,e/150),cc.fadeOut(1)),cc.callFunc(function(){s.active=!1})))}}),cc._RF.pop()},{}]},{},["Fruit","Game","GameOver","Juice"]);